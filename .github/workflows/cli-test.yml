name: cli lint
on:
  pull_request:
    paths:
      - 'apps/cli/**'
  workflow_dispatch:
jobs:
  lint:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./apps/cli
    steps:
      - name: Checkout üê±
        uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }}
      - name: Install uv
        uses: astral-sh/setup-uv@v5
        with:
          # Install a specific version of uv.
          version: "0.6.13"
          enable-cache: true
          cache-dependency-glob: "apps/cli/uv.lock"
      - name: Set up Python üê±
        uses: actions/setup-python@v5
        with:
          python-version-file: "apps/cli/pyproject.toml"
      - name: Install the project
        run: uv sync --all-extras --dev
      - name: Run cli-only pytest tests
        run: uv run pytest test_e2e.py::test_help test_e2e.py::test_version test_failcase.py::test_match_no_gb test_sonar.py::test_no_args
